<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width", initial-scale="1.0">
    <title>George Scannell's Personal Website</title>
    <link href="style.css" rel="stylesheet">
    <script src="spotifyStreamData.js"></script>
    <script src="https://kit.fontawesome.com/ddfda15c1c.js" crossorigin="anonymous"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
</head>

<body class="grey-body">

<header class="nav-bottom-line">
    <nav class="standard-nav">
        <ul class="menu">
            <li class="logo"><a href="index.html">George Scannell</a></li>
            <li class="item"><a href="gallery.html">Gallery</a></li>
            <li class="item has-submenu">
                <a tabindex="0">Favourites</a>
                <ul class="submenu">
                    <li class="subitem"><a href="music.html">Music</a></li>
                    <li class="subitem"><a href="filmsAndTV.html">Films/TV</a></li>
                    <li class="subitem"><a href="quotes.html">Quotes</a></li>
                </ul>
            </li>
            <li class="item"><a href="media.html">Media</a></li>
            <li class="item has-submenu">
                <a tabindex="0" class="active-nav-link">Projects</a>
                <ul class="submenu">
                    <li class="subitem"><a href="spotifyStreamData.html" class="active-nav-link"> Spotify Data</a></li>
                </ul>
            </li>
            <li class="toggle"><a href="#"><i class="fas fa-bars"></i></a></li>
        </ul>
    </nav>
</header>

<!-- Spotify history thing, spotify ticketmaster, tiktok satisfying thing, DISSERTATION code  -->

<main class="main-spotify-stream-data">


<form class="upload">
    <input type="file" name="uploadFile" value="Select your JSON files" multiple />
    <input type="submit" value="Submit" />
    <p1>
        Use the browse function above to submit all of your JSON files provided by Spotify. 
        Extract the .zip file "my_spotify_data" and the files should be within the enclosed "MyData" folder.
        Select all files which follow the naming format "endsong_(X)"
        i.e. endsong_0, endsong_1, endsong_2 etc. Do NOT select the "endvideo" file.</p1>
    <p1>
        The data provided by Spotify contains all streams irrespective of time listened.
        This means that, for example, songs that were skipped through whilst a preferable one was being
        looked for are still captured in the data. This could negatively skew the results, and so by default all streams which are less than 30 seconds are ignored.
        This threshold can be adjusted with the input box at the bottom of the results page.</p1>
    </p1>
    <p1>
        An input box is also provided so that you can adjust the number of results that are displayed
        for your top artists and songs i.e. Your top 30, 50, 100 etc. The default is set at 30. 
    </p1>
    <p1>
        Some of your data may contain certain artists which you do not want to see. A list and search filter is provided whereby you can
        search for the artists that you don't want to be in the data and exclude them by ticking their
        checkbox.
    </p1>
</form>

<h1 class="import-and-processing-header" id="importAndProcessingHeader">Importing and Processing...</h1>

<div class="chart-selector-buttons">
<button type="button" id="artistsChartButton" name="artistsChart">Artists Chart</button>
<button type="button" id="songsChartButton" name="songsChart">Songs Chart</button>
<button type="button" id="artistsChartButton" name="yearsChart">Years Chart</button>
<button type="button" id="songsChartButton" name="monthsChart">Months Chart</button>
<button type="button" id="artistsChartButton" name="timesChart">Times Chart</button>
</div>

<div class="graphs-div" id="graphsDiv">
<canvas class="bruh" id="artists-chart" name="artistsChart"></canvas>
<canvas id="songs-chart" name="songsChart"></canvas>
<canvas id="years-chart" name="yearsChart"></canvas>
<canvas id="months-chart" name="monthsChart"></canvas>
<canvas id="times-chart" name="timesChart"></canvas>
</div>



<form class="streamLengthAndArtistsExclude" id="streamLengthAndArtistsExclude">
    <p1 class="processing-text" id="processingText">Processing...</p1>
    <input class="streamLengthInput" id="streamLength" name="inputStreamLength" value="" placeholder="Stream length: 30 secs" />
    <input class="streamLengthInput" id="truncateResults" name="inputTruncateResults" value="" placeholder="Length of Results: 30" />
    <input class="artist-search-box" type="text" placeholder="Search for Artist" id="search"/>
    <input class="streamLengthInput" type="submit" value="Confirm new selection" />
    <ol class="artistsList" id="artistsList"></ol>
</form>



<script>

// const filterForm = document.querySelector('#search')
document.getElementById('search').addEventListener('keyup', artistListSearch, false)

const streamLengthAndArtistExcludeForm = document.querySelector('.streamLengthAndArtistsExclude');
streamLengthAndArtistExcludeForm.addEventListener('submit', streamLengthAndArtistsExtractor, false);

// Handle multiple fileuploads
const uploadForm = document.querySelector('.upload');
uploadForm.addEventListener('submit', combineFiles, false);//can be true or false not sure has no effect atm

const chartSelectorButtons = document.querySelectorAll('.chart-selector-buttons button');
chartSelectorButtons.forEach(function(button) {
    button.addEventListener("click", function() {

        const graphsDiv = document.querySelector(".graphs-div");
        for (let i = 0; i < graphsDiv.childElementCount; i++) {
            if (button.name == graphsDiv.children[i].attributes.name.nodeValue) {
                document.querySelector(".graphs-div > [name='" + graphsDiv.children[i].attributes.name.nodeValue + "']").style.display='block';
            }   else {
                document.querySelector(".graphs-div > [name='" + graphsDiv.children[i].attributes.name.nodeValue + "']").style.display = 'none';
            }
            
        }
    });
});


</script>






</main>

</body>

<script src="script.js"></script>

</html>